{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/alabrador/dashboard-ansible-ia/src/app/api/health-summary/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\ntype HealthSummaryResponse = {\n  source: \"mock\";\n  date: string;\n  steps: number;\n  restingHeartRate: number;\n  sleepHours: number;\n  standHours: number;\n  message: string;\n};\n\nfunction parseIntegerEnv(name: string, fallback: number): number {\n  const raw = process.env[name]?.trim();\n  if (!raw) {\n    return fallback;\n  }\n\n  const parsed = Number.parseInt(raw, 10);\n  if (!Number.isFinite(parsed)) {\n    return fallback;\n  }\n\n  return parsed;\n}\n\nfunction parseFloatEnv(name: string, fallback: number): number {\n  const raw = process.env[name]?.trim();\n  if (!raw) {\n    return fallback;\n  }\n\n  const parsed = Number.parseFloat(raw);\n  if (!Number.isFinite(parsed)) {\n    return fallback;\n  }\n\n  return parsed;\n}\n\nfunction clamp(value: number, min: number, max: number): number {\n  return Math.min(max, Math.max(min, value));\n}\n\nfunction buildMessage(steps: number, restingHeartRate: number, sleepHours: number, standHours: number): string {\n  const stepStatus = steps >= 8000 ? \"buen nivel de actividad\" : \"actividad baja\";\n  const sleepStatus = sleepHours >= 7 ? \"descanso adecuado\" : \"podrías dormir un poco más\";\n  const heartStatus = restingHeartRate <= 70 ? \"pulso en rango cómodo\" : \"pulso algo elevado\";\n\n  return `Hoy: ${stepStatus}, ${sleepStatus} y ${heartStatus}.`;\n}\n\nexport async function GET() {\n  const steps = clamp(parseIntegerEnv(\"HEALTH_STEPS\", 7350), 0, 100000);\n  const restingHeartRate = clamp(parseIntegerEnv(\"HEALTH_RESTING_HR\", 64), 30, 220);\n  const sleepHours = clamp(parseFloatEnv(\"HEALTH_SLEEP_HOURS\", 7.1), 0, 24);\n  const standHours = clamp(parseIntegerEnv(\"HEALTH_STAND_HOURS\", 9), 0, 24);\n\n  const response: HealthSummaryResponse = {\n    source: \"mock\",\n    date: new Date().toISOString(),\n    steps,\n    restingHeartRate,\n    sleepHours: Number(sleepHours.toFixed(1)),\n    standHours,\n    message: buildMessage(steps, restingHeartRate, sleepHours, standHours),\n  };\n\n  return NextResponse.json(response);\n}\n"],"names":[],"mappings":";;;;AAAA;;AAYA,SAAS,gBAAgB,IAAY,EAAE,QAAgB;IACrD,MAAM,MAAM,QAAQ,GAAG,CAAC,KAAK,EAAE;IAC/B,IAAI,CAAC,KAAK;QACR,OAAO;IACT;IAEA,MAAM,SAAS,OAAO,QAAQ,CAAC,KAAK;IACpC,IAAI,CAAC,OAAO,QAAQ,CAAC,SAAS;QAC5B,OAAO;IACT;IAEA,OAAO;AACT;AAEA,SAAS,cAAc,IAAY,EAAE,QAAgB;IACnD,MAAM,MAAM,QAAQ,GAAG,CAAC,KAAK,EAAE;IAC/B,IAAI,CAAC,KAAK;QACR,OAAO;IACT;IAEA,MAAM,SAAS,OAAO,UAAU,CAAC;IACjC,IAAI,CAAC,OAAO,QAAQ,CAAC,SAAS;QAC5B,OAAO;IACT;IAEA,OAAO;AACT;AAEA,SAAS,MAAM,KAAa,EAAE,GAAW,EAAE,GAAW;IACpD,OAAO,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,KAAK;AACrC;AAEA,SAAS,aAAa,KAAa,EAAE,gBAAwB,EAAE,UAAkB,EAAE,UAAkB;IACnG,MAAM,aAAa,SAAS,OAAO,4BAA4B;IAC/D,MAAM,cAAc,cAAc,IAAI,sBAAsB;IAC5D,MAAM,cAAc,oBAAoB,KAAK,0BAA0B;IAEvE,OAAO,CAAC,KAAK,EAAE,WAAW,EAAE,EAAE,YAAY,GAAG,EAAE,YAAY,CAAC,CAAC;AAC/D;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM,gBAAgB,gBAAgB,OAAO,GAAG;IAC9D,MAAM,mBAAmB,MAAM,gBAAgB,qBAAqB,KAAK,IAAI;IAC7E,MAAM,aAAa,MAAM,cAAc,sBAAsB,MAAM,GAAG;IACtE,MAAM,aAAa,MAAM,gBAAgB,sBAAsB,IAAI,GAAG;IAEtE,MAAM,WAAkC;QACtC,QAAQ;QACR,MAAM,IAAI,OAAO,WAAW;QAC5B;QACA;QACA,YAAY,OAAO,WAAW,OAAO,CAAC;QACtC;QACA,SAAS,aAAa,OAAO,kBAAkB,YAAY;IAC7D;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B"}}]
}